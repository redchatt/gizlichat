<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>ESC211 | Admin Panel</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root { --blue: #3b82f6; --dark: #020617; }
        body { margin: 0; background: var(--dark); color: white; font-family: sans-serif; overflow: hidden; }
        #canvas { position: fixed; inset: 0; z-index: -1; }
        #login-overlay { position: fixed; inset: 0; display: flex; justify-content: center; align-items: center; background: var(--dark); z-index: 100; }
        .box { background: #1e293b; padding: 40px; border-radius: 20px; border: 1px solid var(--blue); text-align: center; width: 300px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #334155; background: #020617; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: var(--blue); border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: bold; }
        #panel { display: none; padding: 50px; text-align: center; position: relative; z-index: 10; height: 100vh; overflow-y: auto; }
        .user-card { background: #1e293b; padding: 10px; margin: 10px auto; border-radius: 10px; width: 80%; max-width: 500px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--blue); }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div id="login-overlay">
        <div class="box">
            <h2 style="color:var(--blue)">ADMİN GİRİŞİ</h2>
            <input type="text" id="admU" placeholder="İstifadəçi adı">
            <input type="password" id="admP" placeholder="Şifrə">
            <button onclick="authNow()">DAXİL OL</button>
        </div>
    </div>

    <div id="panel">
        <h1>Xoş Gəldin, Escobar211_</h1>
        <div style="background:#1e293b; padding:20px; border-radius:15px; display:inline-block; border:1px solid var(--blue)">
            <h3>Yeni İstifadəçi Əlavə Et</h3>
            <input type="text" id="nName" placeholder="Ad" style="width:200px">
            <input type="text" id="nCode" placeholder="Kod" style="width:200px">
            <button onclick="addNewUser()" style="width:150px">YARAT</button>
            <br>
            <button onclick="clearAllMessages()" style="background:orange; margin-top:10px; width:200px">Bütün Mesajları Sil</button>
        </div>
        <hr style="margin:30px; border-color:#334155">
        <h3>Aktiv İstifadəçilər</h3>
        <div id="uList"></div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDzNOIEJfrKFGzrMzeT0Jaf6OCHBEq_LuA",
            authDomain: "gizlichat-839ce.firebaseapp.com",
            databaseURL: "https://gizlichat-839ce-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "gizlichat-839ce"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function authNow() {
            const u = document.getElementById('admU').value;
            const p = document.getElementById('admP').value;
            
            if(u === "Escobar211_" && p === "anaata2007_1") {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('panel').style.display = 'block';
                loadUsersList();
            } else {
                alert("Məlumatlar səhvdir!");
            }
        }

        function addNewUser() {
            let n = document.getElementById('nName').value;
            let c = document.getElementById('nCode').value;
            if(n && c) {
                db.ref('users/' + c).set({ name: n }).then(() => {
                    alert(n + " əlavə edildi!");
                    document.getElementById('nName').value = "";
                    document.getElementById('nCode').value = "";
                });
            }
        }
        function loadUsersList() {
            db.ref('users').on('value', s => {
                let div = document.getElementById('uList');
                div.innerHTML = "";
                s.forEach(child => {
                    div.innerHTML += 
                        <div class="user-card">
                            <span><b>${child.val().name}</b> (Kod: ${child.key})</span>
                            <button onclick="ban('${child.key}')" style="width:70px; background:red">BAN</button>
                        </div>;
                });
            });
        }

        function ban(k) { if(confirm("Silinsin?")) db.ref('users/' + k).remove(); }
        
        function clearAllMessages() {
            if(confirm("Bütün mesajlar birdəfəlik silinsin?")) db.ref('messages').remove();
        }

        // Animasiya
        const cvs = document.getElementById('canvas');
        const ctx = cvs.getContext('2d');
        let pts = [];
        cvs.width = window.innerWidth; cvs.height = window.innerHeight;
        for(let i=0; i<60; i++) pts.push({x:Math.random()*cvs.width, y:Math.random()*cvs.height, vx:Math.random()-0.5, vy:Math.random()-0.5});
        function draw() {
            ctx.clearRect(0,0,cvs.width,cvs.height); ctx.fillStyle="rgba(59,130,246,0.5)";
            pts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; if(p.x<0p.x>cvs.width)p.vx*=-1; if(p.y<0p.y>cvs.height)p.vy*=-1; ctx.beginPath(); ctx.arc(p.x,p.y,2,0,Math.PI*2); ctx.fill(); });
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
