<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESC211 | Rəis Paneli</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        :root { --blue: #3b82f6; --dark: #020617; --red: #ef4444; --green: #10b981; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', sans-serif; background: var(--dark); color: white; }
        #canvas { position: fixed; inset: 0; z-index: -1; }
        
        #login-overlay { position: fixed; inset: 0; background: var(--dark); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        .login-box { background: #1e293b; padding: 40px; border-radius: 20px; border: 1px solid var(--blue); width: 320px; text-align: center; }
        
        .container { max-width: 900px; margin: 30px auto; padding: 20px; background: rgba(30, 41, 59, 0.85); border-radius: 20px; backdrop-filter: blur(15px); display: none; border: 1px solid #334155; }
        .header-panel { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--blue); margin-bottom: 20px; padding-bottom: 10px; }
        
        .card { background: #0f172a; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #334155; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #334155; background: #020617; color: white; outline: none; box-sizing: border-box; }
        
        .btn { padding: 12px 20px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-blue { background: var(--blue); width: 100%; }
        .btn-red { background: var(--red); }
        .btn-clear { background: #f59e0b; margin-top: 10px; }

        .user-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
        .user-card { background: #1e293b; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid var(--blue); }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <div id="login-overlay">
        <div class="login-box">
            <h2 style="color: var(--blue)">ADMİN GİRİŞİ</h2>
            <input type="text" id="admU" placeholder="Admin Adı">
            <input type="password" id="admP" placeholder="Şifrə">
            <button class="btn btn-blue" onclick="auth()">SİSTEMƏ GİR</button>
        </div>
    </div>

    <div class="container" id="panel">
        <div class="header-panel">
            <h2>Escobar211_ İdarəetmə</h2>
            <button class="btn btn-red" onclick="location.reload()">ÇIXIŞ</button>
        </div>

        <div class="card">
            <h3>Nəzarət Mərkəzi</h3>
            <button class="btn btn-clear" onclick="clearChat()">⚠️ Çatdakı Bütün Mesajları Sil</button>
        </div>

        <div class="card">
            <h3>Yeni İstifadəçi Qoş</h3>
            <input type="text" id="nName" placeholder="Ad (məs: Əhməd)">
            <input type="text" id="nCode" placeholder="Giriş Kodu (məs: ahm789)">
            <button class="btn btn-blue" onclick="addNew()">TƏSDİQLƏ</button>
        </div>

        <h3>Aktiv Girişlər</h3>
        <div id="uList" class="user-list"></div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDzNOIEJfrKFGzrMzeT0Jaf6OCHBEq_LuA",
            authDomain: "gizlichat-839ce.firebaseapp.com",
            databaseURL: "https://gizlichat-839ce-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "gizlichat-839ce"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
      function auth() {
            if(document.getElementById('admU').value === "Escobar211_" && 
               document.getElementById('admP').value === "anaata2007_1") {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('panel').style.display = 'block';
                showUsers();
            } else { alert("Yanlış məlumat!"); }
        }

        function addNew() {
            let n = document.getElementById('nName').value;
            let c = document.getElementById('nCode').value;
            if(n && c) {
                db.ref('users/' + c).set({ name: n }).then(() => {
                    alert(n + " sisteme elave edildi!");
                    document.getElementById('nName').value = "";
                    document.getElementById('nCode').value = "";
                });
            }
        }

        function showUsers() {
            db.ref('users').on('value', snap => {
                let div = document.getElementById('uList');
                div.innerHTML = "";
                snap.forEach(child => {
                    div.innerHTML += 
                        <div class="user-card">
                            <div><b>${child.val().name}</b><br><small>${child.key}</small></div>
                            <button class="btn btn-red" style="padding:5px" onclick="ban('${child.key}')">BAN</button>
                        </div>;
                });
            });
        }

        function ban(c) { if(confirm("Banlansın?")) db.ref('users/' + c).remove(); }
        
        function clearChat() {
            if(confirm("DİQQƏT: Bütün mesajlar silinsin?")) {
                db.ref('messages').remove().then(() => alert("Çat təmizləndi!"));
            }
        }

        // Arxa fon animasiyası
        const cvs = document.getElementById('canvas');
        const ctx = cvs.getContext('2d');
        let pts = [];
        cvs.width = window.innerWidth; cvs.height = window.innerHeight;
        for(let i=0; i<80; i++) pts.push({x:Math.random()*cvs.width, y:Math.random()*cvs.height, vx:Math.random()-0.5, vy:Math.random()-0.5});
        function loop() {
            ctx.clearRect(0,0,cvs.width,cvs.height); ctx.fillStyle="rgba(59,130,246,0.4)";
            pts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; if(p.x<0p.x>cvs.width)p.vx*=-1; if(p.y<0p.y>cvs.height)p.vy*=-1; ctx.beginPath(); ctx.arc(p.x,p.y,2,0,Math.PI*2); ctx.fill(); });
            requestAnimationFrame(loop);
        }
        loop();
    </script>
</body>
</html>
